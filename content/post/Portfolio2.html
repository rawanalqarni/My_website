---
title: "Portfolio2"
output: html_document
---

<script src="/rmarkdown-libs/header-attrs/header-attrs.js"></script>
<script src="/rmarkdown-libs/htmlwidgets/htmlwidgets.js"></script>
<script src="/rmarkdown-libs/plotly-binding/plotly.js"></script>
<script src="/rmarkdown-libs/typedarray/typedarray.min.js"></script>
<script src="/rmarkdown-libs/jquery/jquery.min.js"></script>
<link href="/rmarkdown-libs/crosstalk/css/crosstalk.min.css" rel="stylesheet" />
<script src="/rmarkdown-libs/crosstalk/js/crosstalk.min.js"></script>
<link href="/rmarkdown-libs/plotly-htmlwidgets-css/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="/rmarkdown-libs/plotly-main/plotly-latest.min.js"></script>


<div id="fitbit-fitness-tracker-data" class="section level1">
<h1>FitBit Fitness Tracker Data</h1>
<p><img src="/home/rstudio/Documents/Misk_DSI_data/private/img.jpg" width="100%" style="display: block; margin: auto;" /></p>
<p>This dataset generated by respondents to a distributed survey via Amazon Mechanical Turk between 03.12.2016-05.12.2016. Thirty eligible Fitbit users consented to the submission of personal tracker data.<a href="https://www.kaggle.com/arashnic/fitbit">dataset in kaggle</a></p>
<div id="main-question-to-answer-in-this-report" class="section level2">
<h2>Main Question to answer in this Report :</h2>
<ol style="list-style-type: decimal">
<li>How much active the users using fitbit tracker?</li>
<li>What factors could affect the activity level of the user?</li>
<li>Is there any improvement in the users weight?</li>
</ol>
</div>
<div id="read-data" class="section level2">
<h2>read data</h2>
<pre class="r"><code>df_fitness &lt;- read.csv(file = &#39;~/Documents/Misk_DSI_data/private/dailyActivity_merged.csv&#39;)</code></pre>
</div>
<div id="exploring-the-dataset" class="section level2">
<h2>Exploring the dataset</h2>
<pre class="r"><code>knitr::kable(head(df_fitness))</code></pre>
<table>
<colgroup>
<col width="4%" />
<col width="4%" />
<col width="4%" />
<col width="5%" />
<col width="6%" />
<col width="9%" />
<col width="7%" />
<col width="9%" />
<col width="7%" />
<col width="9%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="6%" />
<col width="3%" />
</colgroup>
<thead>
<tr class="header">
<th align="right">Id</th>
<th align="left">ActivityDate</th>
<th align="right">TotalSteps</th>
<th align="right">TotalDistance</th>
<th align="right">TrackerDistance</th>
<th align="right">LoggedActivitiesDistance</th>
<th align="right">VeryActiveDistance</th>
<th align="right">ModeratelyActiveDistance</th>
<th align="right">LightActiveDistance</th>
<th align="right">SedentaryActiveDistance</th>
<th align="right">VeryActiveMinutes</th>
<th align="right">FairlyActiveMinutes</th>
<th align="right">LightlyActiveMinutes</th>
<th align="right">SedentaryMinutes</th>
<th align="right">Calories</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1503960366</td>
<td align="left">4/12/2016</td>
<td align="right">13162</td>
<td align="right">8.50</td>
<td align="right">8.50</td>
<td align="right">0</td>
<td align="right">1.88</td>
<td align="right">0.55</td>
<td align="right">6.06</td>
<td align="right">0</td>
<td align="right">25</td>
<td align="right">13</td>
<td align="right">328</td>
<td align="right">728</td>
<td align="right">1985</td>
</tr>
<tr class="even">
<td align="right">1503960366</td>
<td align="left">4/13/2016</td>
<td align="right">10735</td>
<td align="right">6.97</td>
<td align="right">6.97</td>
<td align="right">0</td>
<td align="right">1.57</td>
<td align="right">0.69</td>
<td align="right">4.71</td>
<td align="right">0</td>
<td align="right">21</td>
<td align="right">19</td>
<td align="right">217</td>
<td align="right">776</td>
<td align="right">1797</td>
</tr>
<tr class="odd">
<td align="right">1503960366</td>
<td align="left">4/14/2016</td>
<td align="right">10460</td>
<td align="right">6.74</td>
<td align="right">6.74</td>
<td align="right">0</td>
<td align="right">2.44</td>
<td align="right">0.40</td>
<td align="right">3.91</td>
<td align="right">0</td>
<td align="right">30</td>
<td align="right">11</td>
<td align="right">181</td>
<td align="right">1218</td>
<td align="right">1776</td>
</tr>
<tr class="even">
<td align="right">1503960366</td>
<td align="left">4/15/2016</td>
<td align="right">9762</td>
<td align="right">6.28</td>
<td align="right">6.28</td>
<td align="right">0</td>
<td align="right">2.14</td>
<td align="right">1.26</td>
<td align="right">2.83</td>
<td align="right">0</td>
<td align="right">29</td>
<td align="right">34</td>
<td align="right">209</td>
<td align="right">726</td>
<td align="right">1745</td>
</tr>
<tr class="odd">
<td align="right">1503960366</td>
<td align="left">4/16/2016</td>
<td align="right">12669</td>
<td align="right">8.16</td>
<td align="right">8.16</td>
<td align="right">0</td>
<td align="right">2.71</td>
<td align="right">0.41</td>
<td align="right">5.04</td>
<td align="right">0</td>
<td align="right">36</td>
<td align="right">10</td>
<td align="right">221</td>
<td align="right">773</td>
<td align="right">1863</td>
</tr>
<tr class="even">
<td align="right">1503960366</td>
<td align="left">4/17/2016</td>
<td align="right">9705</td>
<td align="right">6.48</td>
<td align="right">6.48</td>
<td align="right">0</td>
<td align="right">3.19</td>
<td align="right">0.78</td>
<td align="right">2.51</td>
<td align="right">0</td>
<td align="right">38</td>
<td align="right">20</td>
<td align="right">164</td>
<td align="right">539</td>
<td align="right">1728</td>
</tr>
</tbody>
</table>
<pre class="r"><code>str(df_fitness)</code></pre>
<pre><code>## &#39;data.frame&#39;:    940 obs. of  15 variables:
##  $ Id                      : num  1.5e+09 1.5e+09 1.5e+09 1.5e+09 1.5e+09 ...
##  $ ActivityDate            : chr  &quot;4/12/2016&quot; &quot;4/13/2016&quot; &quot;4/14/2016&quot; &quot;4/15/2016&quot; ...
##  $ TotalSteps              : int  13162 10735 10460 9762 12669 9705 13019 15506 10544 9819 ...
##  $ TotalDistance           : num  8.5 6.97 6.74 6.28 8.16 ...
##  $ TrackerDistance         : num  8.5 6.97 6.74 6.28 8.16 ...
##  $ LoggedActivitiesDistance: num  0 0 0 0 0 0 0 0 0 0 ...
##  $ VeryActiveDistance      : num  1.88 1.57 2.44 2.14 2.71 ...
##  $ ModeratelyActiveDistance: num  0.55 0.69 0.4 1.26 0.41 ...
##  $ LightActiveDistance     : num  6.06 4.71 3.91 2.83 5.04 ...
##  $ SedentaryActiveDistance : num  0 0 0 0 0 0 0 0 0 0 ...
##  $ VeryActiveMinutes       : int  25 21 30 29 36 38 42 50 28 19 ...
##  $ FairlyActiveMinutes     : int  13 19 11 34 10 20 16 31 12 8 ...
##  $ LightlyActiveMinutes    : int  328 217 181 209 221 164 233 264 205 211 ...
##  $ SedentaryMinutes        : int  728 776 1218 726 773 539 1149 775 818 838 ...
##  $ Calories                : int  1985 1797 1776 1745 1863 1728 1921 2035 1786 1775 ...</code></pre>
<pre class="r"><code>knitr::kable(summary(df_fitness))</code></pre>
<table>
<colgroup>
<col width="1%" />
<col width="6%" />
<col width="5%" />
<col width="4%" />
<col width="5%" />
<col width="5%" />
<col width="8%" />
<col width="6%" />
<col width="8%" />
<col width="7%" />
<col width="8%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="5%" />
<col width="4%" />
</colgroup>
<thead>
<tr class="header">
<th align="left"></th>
<th align="left">Id</th>
<th align="left">ActivityDate</th>
<th align="left">TotalSteps</th>
<th align="left">TotalDistance</th>
<th align="left">TrackerDistance</th>
<th align="left">LoggedActivitiesDistance</th>
<th align="left">VeryActiveDistance</th>
<th align="left">ModeratelyActiveDistance</th>
<th align="left">LightActiveDistance</th>
<th align="left">SedentaryActiveDistance</th>
<th align="left">VeryActiveMinutes</th>
<th align="left">FairlyActiveMinutes</th>
<th align="left">LightlyActiveMinutes</th>
<th align="left">SedentaryMinutes</th>
<th align="left">Calories</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"></td>
<td align="left">Min. :1.504e+09</td>
<td align="left">Length:940</td>
<td align="left">Min. : 0</td>
<td align="left">Min. : 0.000</td>
<td align="left">Min. : 0.000</td>
<td align="left">Min. :0.0000</td>
<td align="left">Min. : 0.000</td>
<td align="left">Min. :0.0000</td>
<td align="left">Min. : 0.000</td>
<td align="left">Min. :0.000000</td>
<td align="left">Min. : 0.00</td>
<td align="left">Min. : 0.00</td>
<td align="left">Min. : 0.0</td>
<td align="left">Min. : 0.0</td>
<td align="left">Min. : 0</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">1st Qu.:2.320e+09</td>
<td align="left">Class :character</td>
<td align="left">1st Qu.: 3790</td>
<td align="left">1st Qu.: 2.620</td>
<td align="left">1st Qu.: 2.620</td>
<td align="left">1st Qu.:0.0000</td>
<td align="left">1st Qu.: 0.000</td>
<td align="left">1st Qu.:0.0000</td>
<td align="left">1st Qu.: 1.945</td>
<td align="left">1st Qu.:0.000000</td>
<td align="left">1st Qu.: 0.00</td>
<td align="left">1st Qu.: 0.00</td>
<td align="left">1st Qu.:127.0</td>
<td align="left">1st Qu.: 729.8</td>
<td align="left">1st Qu.:1828</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">Median :4.445e+09</td>
<td align="left">Mode :character</td>
<td align="left">Median : 7406</td>
<td align="left">Median : 5.245</td>
<td align="left">Median : 5.245</td>
<td align="left">Median :0.0000</td>
<td align="left">Median : 0.210</td>
<td align="left">Median :0.2400</td>
<td align="left">Median : 3.365</td>
<td align="left">Median :0.000000</td>
<td align="left">Median : 4.00</td>
<td align="left">Median : 6.00</td>
<td align="left">Median :199.0</td>
<td align="left">Median :1057.5</td>
<td align="left">Median :2134</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">Mean :4.855e+09</td>
<td align="left">NA</td>
<td align="left">Mean : 7638</td>
<td align="left">Mean : 5.490</td>
<td align="left">Mean : 5.475</td>
<td align="left">Mean :0.1082</td>
<td align="left">Mean : 1.503</td>
<td align="left">Mean :0.5675</td>
<td align="left">Mean : 3.341</td>
<td align="left">Mean :0.001606</td>
<td align="left">Mean : 21.16</td>
<td align="left">Mean : 13.56</td>
<td align="left">Mean :192.8</td>
<td align="left">Mean : 991.2</td>
<td align="left">Mean :2304</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">3rd Qu.:6.962e+09</td>
<td align="left">NA</td>
<td align="left">3rd Qu.:10727</td>
<td align="left">3rd Qu.: 7.713</td>
<td align="left">3rd Qu.: 7.710</td>
<td align="left">3rd Qu.:0.0000</td>
<td align="left">3rd Qu.: 2.053</td>
<td align="left">3rd Qu.:0.8000</td>
<td align="left">3rd Qu.: 4.782</td>
<td align="left">3rd Qu.:0.000000</td>
<td align="left">3rd Qu.: 32.00</td>
<td align="left">3rd Qu.: 19.00</td>
<td align="left">3rd Qu.:264.0</td>
<td align="left">3rd Qu.:1229.5</td>
<td align="left">3rd Qu.:2793</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">Max. :8.878e+09</td>
<td align="left">NA</td>
<td align="left">Max. :36019</td>
<td align="left">Max. :28.030</td>
<td align="left">Max. :28.030</td>
<td align="left">Max. :4.9421</td>
<td align="left">Max. :21.920</td>
<td align="left">Max. :6.4800</td>
<td align="left">Max. :10.710</td>
<td align="left">Max. :0.110000</td>
<td align="left">Max. :210.00</td>
<td align="left">Max. :143.00</td>
<td align="left">Max. :518.0</td>
<td align="left">Max. :1440.0</td>
<td align="left">Max. :4900</td>
</tr>
</tbody>
</table>
<ul>
<li>Checking for duplicate and null values</li>
</ul>
<pre class="r"><code>noquote(paste(sum(duplicated(df_fitness)), &quot;duplicate, GREAT&quot;))</code></pre>
<pre><code>## [1] 0 duplicate, GREAT</code></pre>
<pre class="r"><code>noquote(paste(sum(is.null(df_fitness)), &quot;Null value, SUPER&quot;))</code></pre>
<pre><code>## [1] 0 Null value, SUPER</code></pre>
<ul>
<li>How many users we have in the dataset?</li>
</ul>
<pre class="r"><code>noquote(paste(length(unique(df_fitness$Id)), &quot;Users&quot;))</code></pre>
<pre><code>## [1] 33 Users</code></pre>
<ul>
<li>How many non-zero value in Logged Activities Distance column?</li>
</ul>
<pre class="r"><code>non_zero &lt;- sum(df_fitness$LoggedActivitiesDistance != 0)
total &lt;- length(df_fitness$Id)
percentage &lt;- (non_zero/total)*100
noquote(paste(round(percentage,2), &quot;%&quot;))</code></pre>
<pre><code>## [1] 3.4 %</code></pre>
<p>Since it only 3% of the column is available and we have other informative features than “LoggedActivitiesDistance” I will ignore this column.</p>
<div id="q1how-much-active-the-users-using-fitbit-tracker" class="section level4">
<h4>Q1:How much active the users using fitbit tracker?</h4>
<ul>
<li>create a new dataframe having ID and Total_steps_mean and activity level</li>
</ul>
<pre class="r"><code>User_activity_level &lt;- df_fitness %&gt;%
  group_by(Id) %&gt;%
  summarise(Total_steps_mean=mean(TotalSteps))</code></pre>
<pre class="r"><code>knitr::kable(head(User_activity_level))</code></pre>
<table>
<thead>
<tr class="header">
<th align="right">Id</th>
<th align="right">Total_steps_mean</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1503960366</td>
<td align="right">12116.742</td>
</tr>
<tr class="even">
<td align="right">1624580081</td>
<td align="right">5743.903</td>
</tr>
<tr class="odd">
<td align="right">1644430081</td>
<td align="right">7282.967</td>
</tr>
<tr class="even">
<td align="right">1844505072</td>
<td align="right">2580.065</td>
</tr>
<tr class="odd">
<td align="right">1927972279</td>
<td align="right">916.129</td>
</tr>
<tr class="even">
<td align="right">2022484408</td>
<td align="right">11370.645</td>
</tr>
</tbody>
</table>
<ul>
<li>Categorize users into 5 activity levels based on total steps</li>
</ul>
<ol style="list-style-type: decimal">
<li>Sedentary</li>
<li>Low active</li>
<li>Somewhat active</li>
<li>Active</li>
<li>Highly active</li>
</ol>
<pre class="r"><code>User_activity_level &lt;- User_activity_level %&gt;%
  mutate(activity_level = case_when(
    Total_steps_mean &lt; 2000 ~ &quot;sedentary&quot;,
    Total_steps_mean &gt;= 2000 &amp; Total_steps_mean &lt; 7500 ~ &quot;low active&quot;, 
    Total_steps_mean &gt;= 7500 &amp; Total_steps_mean &lt; 10000 ~ &quot;somewhat active&quot;, 
    Total_steps_mean &gt;= 10000 &amp; Total_steps_mean &lt; 12500 ~ &quot;active&quot;,
    Total_steps_mean &gt;= 12500 ~ &quot;highly active&quot;,
  ))</code></pre>
<ul>
<li>Visualize the different user activity category</li>
</ul>
<div id="htmlwidget-1" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-1">{"x":{"visdat":{"10a343a4e0a9":["function () ","plotlyVisDat"]},"cur_data":"10a343a4e0a9","attrs":{"10a343a4e0a9":{"x":{},"color":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1],"automargin":true,"title":"Total_steps_mean"},"yaxis":{"domain":[0,1],"automargin":true},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[12116.7419354839,11370.6451612903,10984.5666666667,10813.935483871,11323.4230769231],"type":"bar","orientation":"h","name":"active","marker":{"color":"rgba(102,194,165,1)","line":{"color":"rgba(102,194,165,1)"}},"textfont":{"color":"rgba(102,194,165,1)"},"error_y":{"color":"rgba(102,194,165,1)"},"error_x":{"color":"rgba(102,194,165,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[14763.2903225806,16040.0322580645],"type":"bar","orientation":"h","name":"highly active","marker":{"color":"rgba(252,141,98,1)","line":{"color":"rgba(252,141,98,1)"}},"textfont":{"color":"rgba(252,141,98,1)"},"error_y":{"color":"rgba(252,141,98,1)"},"error_x":{"color":"rgba(252,141,98,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[5743.90322580645,7282.96666666667,2580.06451612903,5566.87096774194,4716.87096774194,6861.65,2267.22580645161,3838,7268.83870967742,4796.54838709677,7046.71428571429,5649.55172413793,2519.69230769231,6482.15789473684,7198.51612903226],"type":"bar","orientation":"h","name":"low active","marker":{"color":"rgba(141,160,203,1)","line":{"color":"rgba(141,160,203,1)"}},"textfont":{"color":"rgba(141,160,203,1)"},"error_y":{"color":"rgba(141,160,203,1)"},"error_x":{"color":"rgba(141,160,203,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[916.129032258065,1853.72413793103],"type":"bar","orientation":"h","name":"sedentary","marker":{"color":"rgba(231,138,195,1)","line":{"color":"rgba(231,138,195,1)"}},"textfont":{"color":"rgba(231,138,195,1)"},"error_y":{"color":"rgba(231,138,195,1)"},"error_x":{"color":"rgba(231,138,195,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[9519.66666666667,7555.77419354839,7685.12903225806,8572.06451612903,8612.58064516129,8304.43333333333,9794.8064516129,9371.77419354839,8717.70967741935],"type":"bar","orientation":"h","name":"somewhat active","marker":{"color":"rgba(166,216,84,1)","line":{"color":"rgba(166,216,84,1)"}},"textfont":{"color":"rgba(166,216,84,1)"},"error_y":{"color":"rgba(166,216,84,1)"},"error_x":{"color":"rgba(166,216,84,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p>Majority of users are low active type, that lead us to the next question what are the factors of low activity level?</p>
</div>
<div id="q2-what-could-affect-activity-levels-is-the-weekday-month-have-a-influnce-on-users" class="section level4">
<h4>Q2: what could affect activity levels? is the weekday, month have a influnce on users?</h4>
</div>
<div id="dataframe-formatting" class="section level4">
<h4>Dataframe formatting:</h4>
<ul>
<li>Changing the date format in order to extract months and days to new columns</li>
</ul>
<pre class="r"><code>df_fitness &lt;- df_fitness %&gt;%
   mutate(ActivityDate=as.Date(ActivityDate, format = &quot;%m/%d/%Y&quot;)) 

#month column
df_fitness &lt;- df_fitness %&gt;%
  mutate(month = format(df_fitness$ActivityDate, &quot;%b&quot;))

#day column 
df_fitness &lt;- df_fitness %&gt;%
  mutate(day = format(df_fitness$ActivityDate, &quot;%A&quot;))

knitr::kable(head(df_fitness))</code></pre>
<table>
<colgroup>
<col width="3%" />
<col width="4%" />
<col width="3%" />
<col width="5%" />
<col width="5%" />
<col width="8%" />
<col width="6%" />
<col width="8%" />
<col width="7%" />
<col width="8%" />
<col width="6%" />
<col width="7%" />
<col width="7%" />
<col width="6%" />
<col width="3%" />
<col width="2%" />
<col width="3%" />
</colgroup>
<thead>
<tr class="header">
<th align="right">Id</th>
<th align="left">ActivityDate</th>
<th align="right">TotalSteps</th>
<th align="right">TotalDistance</th>
<th align="right">TrackerDistance</th>
<th align="right">LoggedActivitiesDistance</th>
<th align="right">VeryActiveDistance</th>
<th align="right">ModeratelyActiveDistance</th>
<th align="right">LightActiveDistance</th>
<th align="right">SedentaryActiveDistance</th>
<th align="right">VeryActiveMinutes</th>
<th align="right">FairlyActiveMinutes</th>
<th align="right">LightlyActiveMinutes</th>
<th align="right">SedentaryMinutes</th>
<th align="right">Calories</th>
<th align="left">month</th>
<th align="left">day</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1503960366</td>
<td align="left">2016-04-12</td>
<td align="right">13162</td>
<td align="right">8.50</td>
<td align="right">8.50</td>
<td align="right">0</td>
<td align="right">1.88</td>
<td align="right">0.55</td>
<td align="right">6.06</td>
<td align="right">0</td>
<td align="right">25</td>
<td align="right">13</td>
<td align="right">328</td>
<td align="right">728</td>
<td align="right">1985</td>
<td align="left">Apr</td>
<td align="left">Tuesday</td>
</tr>
<tr class="even">
<td align="right">1503960366</td>
<td align="left">2016-04-13</td>
<td align="right">10735</td>
<td align="right">6.97</td>
<td align="right">6.97</td>
<td align="right">0</td>
<td align="right">1.57</td>
<td align="right">0.69</td>
<td align="right">4.71</td>
<td align="right">0</td>
<td align="right">21</td>
<td align="right">19</td>
<td align="right">217</td>
<td align="right">776</td>
<td align="right">1797</td>
<td align="left">Apr</td>
<td align="left">Wednesday</td>
</tr>
<tr class="odd">
<td align="right">1503960366</td>
<td align="left">2016-04-14</td>
<td align="right">10460</td>
<td align="right">6.74</td>
<td align="right">6.74</td>
<td align="right">0</td>
<td align="right">2.44</td>
<td align="right">0.40</td>
<td align="right">3.91</td>
<td align="right">0</td>
<td align="right">30</td>
<td align="right">11</td>
<td align="right">181</td>
<td align="right">1218</td>
<td align="right">1776</td>
<td align="left">Apr</td>
<td align="left">Thursday</td>
</tr>
<tr class="even">
<td align="right">1503960366</td>
<td align="left">2016-04-15</td>
<td align="right">9762</td>
<td align="right">6.28</td>
<td align="right">6.28</td>
<td align="right">0</td>
<td align="right">2.14</td>
<td align="right">1.26</td>
<td align="right">2.83</td>
<td align="right">0</td>
<td align="right">29</td>
<td align="right">34</td>
<td align="right">209</td>
<td align="right">726</td>
<td align="right">1745</td>
<td align="left">Apr</td>
<td align="left">Friday</td>
</tr>
<tr class="odd">
<td align="right">1503960366</td>
<td align="left">2016-04-16</td>
<td align="right">12669</td>
<td align="right">8.16</td>
<td align="right">8.16</td>
<td align="right">0</td>
<td align="right">2.71</td>
<td align="right">0.41</td>
<td align="right">5.04</td>
<td align="right">0</td>
<td align="right">36</td>
<td align="right">10</td>
<td align="right">221</td>
<td align="right">773</td>
<td align="right">1863</td>
<td align="left">Apr</td>
<td align="left">Saturday</td>
</tr>
<tr class="even">
<td align="right">1503960366</td>
<td align="left">2016-04-17</td>
<td align="right">9705</td>
<td align="right">6.48</td>
<td align="right">6.48</td>
<td align="right">0</td>
<td align="right">3.19</td>
<td align="right">0.78</td>
<td align="right">2.51</td>
<td align="right">0</td>
<td align="right">38</td>
<td align="right">20</td>
<td align="right">164</td>
<td align="right">539</td>
<td align="right">1728</td>
<td align="left">Apr</td>
<td align="left">Sunday</td>
</tr>
</tbody>
</table>
<ul>
<li>Create a new dataframe that hold sum_activity and grouped by Id and month</li>
</ul>
<pre class="r"><code>monthly_data &lt;- df_fitness %&gt;%
  group_by( Id,month)%&gt;%
  summarise(sum_activity = sum(VeryActiveMinutes, FairlyActiveMinutes,LightlyActiveMinutes,SedentaryMinutes), calories =sum(Calories))</code></pre>
<pre><code>## `summarise()` has grouped output by &#39;Id&#39;. You can override using the `.groups`
## argument.</code></pre>
<pre class="r"><code>knitr::kable(head(monthly_data))</code></pre>
<table>
<thead>
<tr class="header">
<th align="right">Id</th>
<th align="left">month</th>
<th align="right">sum_activity</th>
<th align="right">calories</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1503960366</td>
<td align="left">Apr</td>
<td align="right">21423</td>
<td align="right">35799</td>
</tr>
<tr class="even">
<td align="right">1503960366</td>
<td align="left">May</td>
<td align="right">13482</td>
<td align="right">20510</td>
</tr>
<tr class="odd">
<td align="right">1624580081</td>
<td align="left">Apr</td>
<td align="right">27360</td>
<td align="right">28401</td>
</tr>
<tr class="even">
<td align="right">1624580081</td>
<td align="left">May</td>
<td align="right">16837</td>
<td align="right">17583</td>
</tr>
<tr class="odd">
<td align="right">1644430081</td>
<td align="left">Apr</td>
<td align="right">27091</td>
<td align="right">54252</td>
</tr>
<tr class="even">
<td align="right">1644430081</td>
<td align="left">May</td>
<td align="right">14047</td>
<td align="right">30087</td>
</tr>
</tbody>
</table>
</div>
<div id="now-after-formatting-our-dataframe-lets-see-the-if-the-month-have-an-influence-on-users-activity" class="section level4">
<h4>Now after formatting our dataframe let’s see the if the month have an influence on users activity?</h4>
<p><img src="/post/Portfolio2_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
</div>
<div id="lets-see-the-if-the-day-have-an-influnce-on-users-activity" class="section level4">
<h4>let’s see the if the day have an influnce on users activity?</h4>
<p><img src="/post/Portfolio2_files/figure-html/unnamed-chunk-17-1.png" width="672" />
From the graph we can see that weekend have drop in total steps and sum activity, which means that weekdays have an affect on the users activity level.</p>
</div>
<div id="other-question-could-be-raised-here-is-there-a-prefered-hours-to-exersice" class="section level4">
<h4>other question could be raised here is there a prefered hours to exersice?</h4>
<ul>
<li>By useing Hourly Intensities dataset we can answer this:</li>
</ul>
<pre class="r"><code>df_Intensities &lt;- read.csv(file = &#39;~/Documents/Misk_DSI_data/private/hourlyIntensities_merged.csv&#39;)
knitr::kable(head(df_Intensities))</code></pre>
<table>
<thead>
<tr class="header">
<th align="right">Id</th>
<th align="left">ActivityHour</th>
<th align="right">TotalIntensity</th>
<th align="right">AverageIntensity</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1503960366</td>
<td align="left">4/12/2016 12:00:00 AM</td>
<td align="right">20</td>
<td align="right">0.333333</td>
</tr>
<tr class="even">
<td align="right">1503960366</td>
<td align="left">4/12/2016 1:00:00 AM</td>
<td align="right">8</td>
<td align="right">0.133333</td>
</tr>
<tr class="odd">
<td align="right">1503960366</td>
<td align="left">4/12/2016 2:00:00 AM</td>
<td align="right">7</td>
<td align="right">0.116667</td>
</tr>
<tr class="even">
<td align="right">1503960366</td>
<td align="left">4/12/2016 3:00:00 AM</td>
<td align="right">0</td>
<td align="right">0.000000</td>
</tr>
<tr class="odd">
<td align="right">1503960366</td>
<td align="left">4/12/2016 4:00:00 AM</td>
<td align="right">0</td>
<td align="right">0.000000</td>
</tr>
<tr class="even">
<td align="right">1503960366</td>
<td align="left">4/12/2016 5:00:00 AM</td>
<td align="right">0</td>
<td align="right">0.000000</td>
</tr>
</tbody>
</table>
<ul>
<li>Dataframe Formatting:</li>
</ul>
<pre class="r"><code>df_Intensities$ActivityHour &lt;- strptime(df_Intensities$ActivityHour,format=&quot;%m/%d/%Y %H:%M:%S&quot;)

df_Intensities$Time &lt;- format(as.POSIXct(df_Intensities$ActivityHour,format=&quot;%Y:%m:%d %H:%M:%S&quot;),&quot;%H:%M:%S&quot;)

df_Intensities$Date &lt;- as.Date(df_Intensities$ActivityHour, format = &quot;%m:%d:%Y&quot;)

str(df_Intensities)</code></pre>
<pre><code>## &#39;data.frame&#39;:    22099 obs. of  6 variables:
##  $ Id              : num  1.5e+09 1.5e+09 1.5e+09 1.5e+09 1.5e+09 ...
##  $ ActivityHour    : POSIXlt, format: &quot;2016-04-12 12:00:00&quot; &quot;2016-04-12 01:00:00&quot; ...
##  $ TotalIntensity  : int  20 8 7 0 0 0 0 0 13 30 ...
##  $ AverageIntensity: num  0.333 0.133 0.117 0 0 ...
##  $ Time            : chr  &quot;12:00:00&quot; &quot;01:00:00&quot; &quot;02:00:00&quot; &quot;03:00:00&quot; ...
##  $ Date            : Date, format: &quot;2016-04-12&quot; &quot;2016-04-12&quot; ...</code></pre>
<p><img src="/post/Portfolio2_files/figure-html/unnamed-chunk-20-1.png" width="672" />
From the plot it show that users tend to be more active in the hours range 5-7 much more early moring and in the evening</p>
</div>
<div id="q3-is-there-any-improvement-in-the-users-weight-or-average-caleroies-per-day" class="section level4">
<h4>Q3: Is there any improvement in the users weight or average caleroies per day?</h4>
<ul>
<li>By using weight lig info dataset</li>
</ul>
<pre class="r"><code>df_weight &lt;- read.csv(file = &#39;~/Documents/Misk_DSI_data/private/weightLogInfo_merged.csv&#39;)

# I will subset the dataset because there is redundent column like weight in pound
df_weight = subset(df_weight, select = -c(WeightPounds, Fat, LogId))

knitr::kable(head(df_weight))</code></pre>
<table>
<thead>
<tr class="header">
<th align="right">Id</th>
<th align="left">Date</th>
<th align="right">WeightKg</th>
<th align="right">BMI</th>
<th align="left">IsManualReport</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1503960366</td>
<td align="left">5/2/2016 11:59:59 PM</td>
<td align="right">52.6</td>
<td align="right">22.65</td>
<td align="left">True</td>
</tr>
<tr class="even">
<td align="right">1503960366</td>
<td align="left">5/3/2016 11:59:59 PM</td>
<td align="right">52.6</td>
<td align="right">22.65</td>
<td align="left">True</td>
</tr>
<tr class="odd">
<td align="right">1927972279</td>
<td align="left">4/13/2016 1:08:52 AM</td>
<td align="right">133.5</td>
<td align="right">47.54</td>
<td align="left">False</td>
</tr>
<tr class="even">
<td align="right">2873212765</td>
<td align="left">4/21/2016 11:59:59 PM</td>
<td align="right">56.7</td>
<td align="right">21.45</td>
<td align="left">True</td>
</tr>
<tr class="odd">
<td align="right">2873212765</td>
<td align="left">5/12/2016 11:59:59 PM</td>
<td align="right">57.3</td>
<td align="right">21.69</td>
<td align="left">True</td>
</tr>
<tr class="even">
<td align="right">4319703577</td>
<td align="left">4/17/2016 11:59:59 PM</td>
<td align="right">72.4</td>
<td align="right">27.45</td>
<td align="left">True</td>
</tr>
</tbody>
</table>
<ul>
<li>Formatting the date column and creating month column</li>
</ul>
<pre class="r"><code>df_weight &lt;- df_weight %&gt;%
   mutate(Date=as.Date(Date, format = &quot;%m/%d/%Y&quot;)) 

df_weight &lt;- df_weight %&gt;%
  mutate(month = format(df_weight$Date, &quot;%m&quot;))

str(df_weight)</code></pre>
<pre><code>## &#39;data.frame&#39;:    67 obs. of  6 variables:
##  $ Id            : num  1.50e+09 1.50e+09 1.93e+09 2.87e+09 2.87e+09 ...
##  $ Date          : Date, format: &quot;2016-05-02&quot; &quot;2016-05-03&quot; ...
##  $ WeightKg      : num  52.6 52.6 133.5 56.7 57.3 ...
##  $ BMI           : num  22.6 22.6 47.5 21.5 21.7 ...
##  $ IsManualReport: chr  &quot;True&quot; &quot;True&quot; &quot;False&quot; &quot;True&quot; ...
##  $ month         : chr  &quot;05&quot; &quot;05&quot; &quot;04&quot; &quot;04&quot; ...</code></pre>
<ul>
<li>Create a new dataset that hold average weight for each user during the two month April and May</li>
</ul>
<pre class="r"><code>weight_monthly_data &lt;- df_weight %&gt;%
  group_by(month, Id)%&gt;%
  summarise(Weight_mean= mean(WeightKg), BMI_mean=mean(BMI))</code></pre>
<pre><code>## `summarise()` has grouped output by &#39;month&#39;. You can override using the
## `.groups` argument.</code></pre>
<pre class="r"><code>knitr::kable(head(weight_monthly_data))</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">month</th>
<th align="right">Id</th>
<th align="right">Weight_mean</th>
<th align="right">BMI_mean</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">04</td>
<td align="right">1927972279</td>
<td align="right">133.50000</td>
<td align="right">47.54000</td>
</tr>
<tr class="even">
<td align="left">04</td>
<td align="right">2873212765</td>
<td align="right">56.70000</td>
<td align="right">21.45000</td>
</tr>
<tr class="odd">
<td align="left">04</td>
<td align="right">4319703577</td>
<td align="right">72.40000</td>
<td align="right">27.45000</td>
</tr>
<tr class="even">
<td align="left">04</td>
<td align="right">4558609924</td>
<td align="right">70.00000</td>
<td align="right">27.35500</td>
</tr>
<tr class="odd">
<td align="left">04</td>
<td align="right">5577150313</td>
<td align="right">90.70000</td>
<td align="right">28.00000</td>
</tr>
<tr class="even">
<td align="left">04</td>
<td align="right">6962181067</td>
<td align="right">61.54445</td>
<td align="right">24.02389</td>
</tr>
</tbody>
</table>
<ul>
<li>Visualizing users average weight and BMI during April and May, some users only have a record for the their weight and BMI in one month only<br />
<img src="/post/Portfolio2_files/figure-html/unnamed-chunk-25-1.png" width="672" /></li>
</ul>
<p>From the plot we can see that there is no big improvement in the users weight neither their BMI.</p>
<ul>
<li>Let’s see users if there any increase or decrease in calories between two month</li>
</ul>
<pre><code>## Warning in RColorBrewer::brewer.pal(N, &quot;Set2&quot;): minimal value for n is 3, returning requested palette with 3 different levels

## Warning in RColorBrewer::brewer.pal(N, &quot;Set2&quot;): minimal value for n is 3, returning requested palette with 3 different levels</code></pre>
<div id="htmlwidget-2" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-2">{"x":{"visdat":{"10a3229665a":["function () ","plotlyVisDat"]},"cur_data":"10a3229665a","attrs":{"10a3229665a":{"x":{},"color":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"bar"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1],"automargin":true,"title":"calories"},"yaxis":{"domain":[0,1],"automargin":true},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[35799,28401,54252,32258,41598,48702,28581,33257,36782,36889,37425,29047,41393,7895,38948,58454,41649,39160,57601,36220,69399,45068,50960,42213,38612,51138,48387,58771,33972,66798,53179,40069,68480],"type":"bar","orientation":"h","name":"Apr","marker":{"color":"rgba(102,194,165,1)","line":{"color":"rgba(102,194,165,1)"}},"textfont":{"color":"rgba(102,194,165,1)"},"error_y":{"color":"rgba(102,194,165,1)"},"error_x":{"color":"rgba(102,194,165,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[20510,17583,30087,16520,25759,29107,19179,20192,22537,1237,16363,32567,24220,37456,26123,23871,34331,21926,31390,18244,24429,13213,22831,15006,31170,32549,39736,31514,16838,37548],"type":"bar","orientation":"h","name":"May","marker":{"color":"rgba(141,160,203,1)","line":{"color":"rgba(141,160,203,1)"}},"textfont":{"color":"rgba(141,160,203,1)"},"error_y":{"color":"rgba(141,160,203,1)"},"error_x":{"color":"rgba(141,160,203,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p>From the plot we can see that April have higher measure than May it could be due to the weather.</p>
</div>
</div>
</div>
